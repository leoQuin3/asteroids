[gd_scene load_steps=4 format=3 uid="uid://blouheg86yvxd"]

[ext_resource type="Texture2D" uid="uid://dkrthvicup8k5" path="res://sprites/spaceship.png" id="1_iyh7c"]
[ext_resource type="PackedScene" uid="uid://cltcpn726slgt" path="res://scenes/entities/weapons/weapon.tscn" id="3_2763h"]

[sub_resource type="GDScript" id="GDScript_shegr"]
script/source = "extends CharacterBody2D

class_name Player

const SPEED: float = 300.0
const ROTATION_SPEED: float = 2.0 * PI
var direction: Vector2 = Vector2()
#const MAX_SPEED: float = 500.0

@export var weapon: Weapon
@onready var body_sprite: = $BodySprite
@onready var collider: = $BodyCollision


func _ready():
	print(global_position)

#Movement
func _physics_process(delta):
	#Get input
	var thrust = Input.get_axis(\"ui_up\",\"ui_down\")
	var rotate = Input.get_axis(\"ui_left\", \"ui_right\")
	
	#Rotate ship	
	var shipAngle = rotate * ROTATION_SPEED
	rotation += shipAngle * delta
	
	#Move ship
	if thrust:
		velocity.y += thrust * cos(rotation) * delta * SPEED
		velocity.x += thrust * -sin(rotation) * delta * SPEED
	
	#TODO: Enforce maximum velocity
	
	move_and_slide()

#Input
func _input(event):
	if event.is_action_pressed(\"ui_accept\"):
		weapon.fire()
"

[node name="Player" type="CharacterBody2D" node_paths=PackedStringArray("weapon")]
collision_mask = 14
script = SubResource("GDScript_shegr")
weapon = NodePath("Weapon")

[node name="BodyCollision" type="CollisionPolygon2D" parent="."]
position = Vector2(-3.85186e-34, 2)
scale = Vector2(2.305, 2.305)
polygon = PackedVector2Array(0, -14.4, -13.44, 12.48, 0, 5.76, 13.44, 12.48)

[node name="BodySprite" type="Sprite2D" parent="."]
texture = ExtResource("1_iyh7c")

[node name="Weapon" parent="." instance=ExtResource("3_2763h")]
rotation = 3.14159
